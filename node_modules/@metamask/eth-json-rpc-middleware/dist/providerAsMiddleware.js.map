{"version":3,"file":"providerAsMiddleware.js","sourceRoot":"","sources":["../src/providerAsMiddleware.ts"],"names":[],"mappings":";;;AACA,+DAGmC;AAOnC,SAAgB,oBAAoB,CAClC,QAAkC;IAElC,OAAO,IAAA,uCAAqB,EAAC,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;QAC9C,GAAG,CAAC,MAAM,GAAG,MAAM,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAC3C,CAAC,CAAC,CAAC;AACL,CAAC;AAND,oDAMC;AAED,SAAgB,0BAA0B,CACxC,QAAkC;IAElC,OAAO,CAAC,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,EAAE;QAC9B,2BAA2B;QAC3B,QAAQ,CAAC,IAAI,CACX,GAAG,EACH,CAAC,GAAY,EAAE,WAAwC,EAAE,EAAE;YACzD,oBAAoB;YACpB,IAAI,GAAG,EAAE;gBACP,oFAAoF;gBACpF,sDAAsD;gBACtD,OAAO,GAAG,CAAC,GAAY,CAAC,CAAC;aAC1B;YACD,gDAAgD;YAChD,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC;YAChC,OAAO,GAAG,EAAE,CAAC;QACf,CAAC,CACF,CAAC;IACJ,CAAC,CAAC;AACJ,CAAC;AApBD,gEAoBC","sourcesContent":["import type { SafeEventEmitterProvider } from '@metamask/eth-json-rpc-provider';\nimport {\n  createAsyncMiddleware,\n  type JsonRpcMiddleware,\n} from '@metamask/json-rpc-engine';\nimport type {\n  Json,\n  JsonRpcParams,\n  PendingJsonRpcResponse,\n} from '@metamask/utils';\n\nexport function providerAsMiddleware(\n  provider: SafeEventEmitterProvider,\n): JsonRpcMiddleware<JsonRpcParams, Json> {\n  return createAsyncMiddleware(async (req, res) => {\n    res.result = await provider.request(req);\n  });\n}\n\nexport function ethersProviderAsMiddleware(\n  provider: SafeEventEmitterProvider,\n): JsonRpcMiddleware<JsonRpcParams, Json> {\n  return (req, res, _next, end) => {\n    // send request to provider\n    provider.send(\n      req,\n      (err: unknown, providerRes: PendingJsonRpcResponse<any>) => {\n        // forward any error\n        if (err) {\n          // TODO: Remove this cast when next major `@metamask/json-rpc-engine` release is out\n          // The next release changes how errors are propogated.\n          return end(err as Error);\n        }\n        // copy provider response onto original response\n        Object.assign(res, providerRes);\n        return end();\n      },\n    );\n  };\n}\n"]}